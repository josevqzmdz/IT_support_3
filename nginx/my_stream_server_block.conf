upstream backend {
    hash $remote_addr consistent;

    server www.itsupportexam.local:8080 weight=5;
    server 172.18.0.50:8080            max_fails=3 fail_timeout=30s;
    server unix:/tmp/backend3;
}

server {
    listen 8080;
    proxy_connect_timeout 1s;
    proxy_timeout 3s;
    proxy_pass backend;
}

server {
    listen       443 ssl;

    ssl_certificate      ./certs/server.crt;
    ssl_certificate_key  ./certs/server.key;

    ssl_session_cache    shared:SSL:1m;
    ssl_session_timeout  5m;

    ssl_ciphers  HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers  on;

    location / {
      root   html;
      index  index.html index.htm;
    }
  }